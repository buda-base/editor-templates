# baseURI: http://purl.bdrc.io/shapes/core/PersonLocalShapes/
# imports: http://purl.bdrc.io/shapes/core/EventLocalShapes/
# prefix: PersonLocalShapes

@prefix PersonLocalShapes: <http://purl.bdrc.io/shapes/core/PersonLocalShapes/> .
@prefix adm: <http://purl.bdrc.io/ontology/admin/> .
@prefix bda: <http://purl.bdrc.io/admin.data/> .
@prefix bdg: <http://purl.bdrc.io/graph/> .
@prefix bdo: <http://purl.bdrc.io/ontology/core/> .
@prefix bdr: <http://purl.bdrc.io/resource/> .
@prefix bds: <http://purl.bdrc.io/ontology/shapes/core/> .
@prefix bdsa: <http://purl.bdrc.io/ontology/shapes/adm/> .
@prefix bf: <http://id.loc.gov/ontologies/bibframe/> .
@prefix dash: <http://datashapes.org/dash#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix tosh: <http://topbraid.org/tosh#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

bdo:Person 
  bds:localShapeGraph bdg:PersonLocalShapes ;
.
PersonLocalShapes:
  a owl:Ontology ;
  owl:imports <http://purl.bdrc.io/shapes/core/EventLocalShapes/> ;
  owl:versionInfo "SHACL constraints for a internal elements of a Person graph" ;
.
bds:PersonShape
  a sh:NodeShape ;
  bds:identifierPrefix "P" ;
  rdfs:label "Person Shape"@en ;
  sh:property bds:PersonShape-personEvent ;
  sh:property bds:PersonShape-personName ;
.
##
## PersonName
##
bds:PersonShape-personName
  a sh:PropertyShape ;
  sh:path bdo:personName ;
  sh:message "There must be at least one :personName object and each must be an IRI - no blank nodes"@en ;
  sh:minCount 1 ;
  sh:nodeKind sh:IRI ;
  bds:propertyShapeType bds:FacetShape ;
.
bds:PersonNameShape
  a sh:NodeShape ;
  bds:nodeShapeType bds:FacetShape ;
  rdfs:label "Person Name Shape"@en ;
  sh:targetObjectsOf bdo:personName ;
  sh:property bds:PersonNameShape-personNameLabel ;
  sh:property bds:PersonNameShape-personNameType ;
  sh:targetClass bdo:PersonName ;
.
bds:PersonNameShape-personNameLabel
  a sh:PropertyShape ;
  sh:path rdfs:label ;
  sh:datatype rdf:langString ;
  sh:message "A PersonName must have exactly one rdfs:label"@en ;
  sh:maxCount 1 ;
  sh:minCount 1 ;
.
bds:PersonNameShape-type
  a sh:PropertyShape ;
  sh:path rdf:type ;
  sh:in (bdo:PersonPrimaryTitle bdo:PersonPrimaryName bdo:PersonPersonalName bdo:PersonCommonName bdo:PersonGterStonTitle bdo:PersonOfficeTitle bdo:PersonPenName bdo:PersonTitle bdo:PersonTulkuTitle bdo:PersonOtherName bdo:PersonBodhisattvaVowName bdo:PersonCorporateName bdo:PersonFamilyName bdo:PersonFinalOrdination bdo:PersonFinalOrdinationName bdo:PersonFirstOrdinationName bdo:PersonOfficialTitle bdo:PersonOriginName bdo:PersonResidenceName bdo:PersonMonasteryName bdo:PersonMonasticPositionName bdo:PersonDonorName bdo:PersonRabByungOrdination bdo:PersonReversal bdo:PersonSecretInitiatoryName bdo:PersonVariantOrthography) ;
  sh:message "A PersonName must have one type"@en ;
  sh:minCount 1 ;
  sh:maxCount 1 ;
.
##
## PersonEvent
##
bds:PersonShape-personEvent
  a sh:PropertyShape ;
  sh:path bdo:personEvent ;
  sh:message ":personEvent object must be an IRI - no blank nodes"@en ;
  sh:nodeKind sh:IRI ;
  bds:propertyShapeType bds:FacetShape ;
.
bds:PersonEventShape
  a sh:NodeShape ;
  bds:nodeShapeType bds:FacetShape ;
  rdfs:label "Person Event Shape"@en ;
  sh:property bds:PersonEventShape-personEventRole , bds:PersonEventShape-type , bds:PersonEventShape-personEventCorporation ;
  sh:targetClass bdo:PersonEvent ;
.
bds:PersonEventShape-personEventRole
  a sh:PropertyShape ;
  sh:path bdo:personEventRole ;
  sh:maxCount 1 ;
  sh:class bdo:Role ;
  sh:message "At most one :personEventRole allowed"@en ;
.
bds:PersonEventShape-personEventCorporation
  a sh:PropertyShape ;
  sh:path bdo:personEventCorporation ;
  sh:maxCount 1 ;
  sh:class bdo:Corporation ;
  sh:message "At most one :personEventCorporation allowed"@en ;
.
bds:PersonEventShape-type
  a sh:PropertyShape ;
  sh:path rdf:type ;
  sh:in ( bdo:PersonBirth bdo:PersonDeath bdo:PersonFlourished bdo:PersonAffiliation bdo:PersonOccupiesSeat bdo:PersonAssumesOffice bdo:PersonFinalOrdination bdo:PersonGterMaDiscovery bdo:PersonInResidence bdo:PersonLeavesOffice bdo:PersonLeavesSeat bdo:PersonMarriage bdo:PersonRabByungOrdination bdo:PersonDivorce bdo:PersonEventNotSpecified ) ;
  sh:message "A PersonEvent must have one type"@en ;
  sh:class bdo:PersonEvent ;
  sh:minCount 1 ;
  sh:maxCount 1 ;
.