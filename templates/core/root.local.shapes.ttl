# baseURI: http://purl.bdrc.io/shapes/core/RootLocalShapes/
# imports: http://purl.bdrc.io/shapes/core/BaseShapes/
# prefix: RootLocalShapes

@prefix RootLocalShapes: <http://purl.bdrc.io/shapes/core/RootLocalShapes/> .
@prefix adm: <http://purl.bdrc.io/ontology/admin/> .
@prefix bdd: <http://purl.bdrc.io/data/> .
@prefix bdo: <http://purl.bdrc.io/ontology/core/> .
@prefix bdr: <http://purl.bdrc.io/resource/> .
@prefix bds: <http://purl.bdrc.io/ontology/shapes/core/> .
@prefix bf: <http://id.loc.gov/ontologies/bibframe/> .
@prefix cc: <http://creativecommons.org/ns#> .
@prefix dash: <http://datashapes.org/dash#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix iiif2: <http://iiif.io/api/presentation/2#> .
@prefix iiif3: <http://iiif.io/api/presentation/3#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix swa: <http://topbraid.org/swa#> .
@prefix tbr: <http://purl.bdrc.io/ontology/toberemoved/> .
@prefix tosh: <http://topbraid.org/tosh#> .
@prefix vcard: <http://www.w3.org/2006/vcard/ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

RootLocalShapes:
  a owl:Ontology ;
  owl:imports <http://purl.bdrc.io/shapes/core/BaseShapes/> ;
  owl:versionInfo "Initial SHACL constraints" ;
.
bds:EntityShape
  a sh:NodeShape ;
  bds:nodeShapeType bds:FacetShape ;
  sh:property bds:EntityShape-skos_prefLabel ;
  sh:property bds:EntityShape-note ;
  sh:targetClass bdo:Entity ;
.
##
## Notes
##
bds:CheckNoteClass  
    a      sh:NodeShape ;
    rdfs:label      "Check Note Class Shape"@en ;
    sh:targetObjectsOf bdo:note ;
    sh:message "focusNode must be a bdo:Note" ;
    sh:sparql [
      a sh:SPARQLConstraint ;
      sh:prefixes bds:RDF, bds:BDO ;
      sh:select """
        select distinct $this
        where {
            filter not exists { $this rdf:type/rdfs:subClassOf* bdo:Note . } .
        }	  
      """ ;
    ] ;
.
bds:EntityShape-note
  a sh:PropertyShape ;
  bds:propertyShapeType bds:FacetShape ;
  sh:message "a note must be an IRI, no blank nodes"@en ;
  sh:path bdo:note ;
  sh:nodeKind sh:IRI ;
.
bds:NoteShape
  a sh:NodeShape ;
  bds:identifierPrefix "NT" ;
  bds:nodeShapeType bds:FacetShape ;
  sh:property bds:NoteShape-contentLocation ;
  sh:property bds:NoteShape-contentLocationStatement ;
  sh:property bds:NoteShape-contentLocationStatementCBETA ;
  sh:property bds:NoteShape-noteText ;
  sh:property bds:NoteShape-noteType ;
  sh:targetClass bdo:Note ;
.
bds:NoteShape-contentLocationStatement
  a sh:PropertyShape ;
  rdfs:label "contentLocationStatement Shape"@en ;
  sh:message "a note may have at most one :contentLocationStatement"@en ;
  sh:path bdo:contentLocationStatement ;
  sh:datatype xsd:string ;
  sh:maxCount 1 ;
.
bds:NoteShape-contentLocationStatementCBETA
  a sh:PropertyShape ;
  rdfs:label "contentLocationStatementCBETA Shape"@en ;
  sh:message "a note may have at most one :contentLocationStatementCBETA"@en ;
  sh:path bdo:contentLocationStatementCBETA ;
  sh:datatype xsd:string ;
  sh:maxCount 1 ;
.
bds:NoteShape-contentLocation
  a sh:PropertyShape ;
  sh:message "a note may have at most one :contentLocation"@en ;
  sh:path bdo:contentLocation ;
  sh:class bdo:ContentLocation ;
  sh:maxCount 1 ;
.
bds:NoteShape-noteText
  a sh:PropertyShape ;
  sh:message "a note may have at most one :noteText"@en ;
  sh:path bdo:noteText ;
  sh:datatype rdf:langString ;
  sh:maxCount 1 ;
.
bds:NoteShape-noteType
  a sh:PropertyShape ;
  sh:message "a note may have at most one :noteType"@en ;
  sh:path bdo:noteType ;
  sh:datatype xsd:string ;
  sh:maxCount 1 ;
.
##
## usage of skos:prefLabels on Entities
##
bds:EntityShape-skos_prefLabel
  a sh:PropertyShape ;
  sh:message "each Entity resource must have at least one skos:prefLabel and each must be a unique language"@en ;
  sh:path skos:prefLabel ;
  sh:datatype rdf:langString ;
  sh:languageIn (
      "en" "zh" "bo" "bo-x-ewts" "km-x-femc" "km" "fr" "km-x-bdrc" 
    ) ;
  sh:minCount 1 ;
  sh:uniqueLang true ;
.
##
## Labels
##
bds:LabelShape
  a sh:NodeShape ;
  rdfs:label "Label Shape"@en ;
  sh:property bds:LabelShape-hasTranslation ;
  sh:targetClass bdo:Label ;
.
bds:LabelShape-hasTranslation
  a sh:PropertyShape ;
  sh:message "a label may refer to other :Labels that are translations of this label"@en ;
  sh:path bdo:hasTranslation ;
  sh:class bdo:Label ;
.
##
## ContentLocations
##
bds:CheckContentLocationClass  
    a      sh:NodeShape ;
    rdfs:label      "Check ContentLocation Class Shape"@en ;
    sh:targetObjectsOf bdo:contentLocation ;
    sh:message "object if :contentLocation must be a bdo:ContentLocation" ;
    sh:sparql [
      a sh:SPARQLConstraint ;
      sh:prefixes bds:RDF, bds:BDO ;
      sh:select """
        select distinct $this
        where {
            filter not exists { $this rdf:type/rdfs:subClassOf* bdo:ContentLocation . } .
        }	  
      """ ;
    ] ;
.
bds:ContentLocationShape
  a sh:NodeShape ;
  bds:identifierPrefix "CL" ;
  rdfs:label "ContentLocation Shape"@en ;
  sh:property bds:ContentLocationShape-contentLocationByFolio ;
  sh:property bds:ContentLocationShape-contentLocationEndLine ;
  sh:property bds:ContentLocationShape-contentLocationEndPage ;
  sh:property bds:ContentLocationShape-contentLocationEndPhrase ;
  sh:property bds:ContentLocationShape-contentLocationEndSide ;
  sh:property bds:ContentLocationShape-contentLocationEndVolume ;
  sh:property bds:ContentLocationShape-contentLocationEndVolumeName ;
  sh:property bds:ContentLocationShape-contentLocationInstance ;
  sh:property bds:ContentLocationShape-contentLocationLine ;
  sh:property bds:ContentLocationShape-contentLocationPage ;
  sh:property bds:ContentLocationShape-contentLocationPhrase ;
  sh:property bds:ContentLocationShape-contentLocationSeqNum ;
  sh:property bds:ContentLocationShape-contentLocationSide ;
  sh:property bds:ContentLocationShape-contentLocationStatement ;
  sh:property bds:ContentLocationShape-contentLocationStatementCBETA ;
  sh:property bds:ContentLocationShape-contentLocationVolume ;
  sh:property bds:ContentLocationShape-contentLocationVolumeName ;
  sh:property bds:ContentLocationShape-contentPagination ;
  sh:targetClass bdo:ContentLocation ;
.
bds:ContentLocationShape-contentLocationByFolio
  a sh:PropertyShape ;
  rdfs:label "contentLocationByFolio Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most once, that units are folios. The default is pages."@en ;
  sh:path bdo:contentLocationByFolio ;
  sh:datatype xsd:boolean ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationEndLine
  a sh:PropertyShape ;
  rdfs:label "contentLocationEndLine Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, ending line."@en ;
  sh:path bdo:contentLocationEndLine ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationEndPage
  a sh:PropertyShape ;
  rdfs:label "contentLocationEndPage Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, ending page."@en ;
  sh:path bdo:contentLocationEndPage ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationEndPhrase
  a sh:PropertyShape ;
  rdfs:label "contentLocationEndPhrase Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, ending phrase number."@en ;
  sh:path bdo:contentLocationEndPhrase ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationEndSide
  a sh:PropertyShape ;
  rdfs:comment "should include constraint that only makes sense when contentLocationByFolio true"@en ;
  rdfs:label "contentLocationEndSide Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, ending side."@en ;
  sh:path bdo:contentLocationEndSide ;
  sh:datatype xsd:string ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationEndVolume
  a sh:PropertyShape ;
  rdfs:label "contentLocationEndVolume Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, ending volume number."@en ;
  sh:path bdo:contentLocationEndVolume ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationEndVolumeName
  a sh:PropertyShape ;
  rdfs:label "contentLocationEndVolumeName Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, ending volume name."@en ;
  sh:path bdo:contentLocationEndVolumeName ;
  sh:datatype xsd:string ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationLine
  a sh:PropertyShape ;
  rdfs:label "contentLocationLine Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, starting line number."@en ;
  sh:path bdo:contentLocationLine ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationPage
  a sh:PropertyShape ;
  rdfs:label "contentLocationPage Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, starting page number."@en ;
  sh:path bdo:contentLocationPage ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationPhrase
  a sh:PropertyShape ;
  rdfs:label "contentLocationPhrase Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, starting phrase number."@en ;
  sh:path bdo:contentLocationPhrase ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationSeqNum
  a sh:PropertyShape ;
  rdfs:label "contentLocationSeqNum Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, sequence number."@en ;
  sh:path bdo:contentLocationSeqNum ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationSide
  a sh:PropertyShape ;
  rdfs:comment "should include constraint that only makes sense when contentLocationByFolio true"@en ;
  rdfs:label "contentLocationSide Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, starting side of a folio."@en ;
  sh:path bdo:contentLocationSide ;
  sh:datatype xsd:string ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationVolume
  a sh:PropertyShape ;
  rdfs:label "contentLocationVolume Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, starting volume number."@en ;
  sh:path bdo:contentLocationVolume ;
  sh:datatype xsd:integer ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentLocationVolumeName
  a sh:PropertyShape ;
  rdfs:label "contentLocationVolumeName Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, starting volume name."@en ;
  sh:path bdo:contentLocationVolumeName ;
  sh:datatype xsd:string ;
  sh:maxCount 1 ;
.
bds:ContentLocationShape-contentPagination
  a sh:PropertyShape ;
  rdfs:label "contentPagination Shape"@en ;
  sh:message "a :ContentLocation may indicate, at most one, pagination type."@en ;
  sh:path bdo:contentPagination ;
  sh:class bdo:PaginationType ;
  sh:maxCount 1 ;
.
